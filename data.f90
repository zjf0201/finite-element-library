 MODULE SparseMatrix
    IMPLICIT NONE
    real(8),ALLOCATABLE::AA(:),M(:),C(:)
    INTEGER,ALLOCATABLE::IA(:),JA(:),IM(:),JM(:),jc(:),ic(:)
    
    complex(8),ALLOCATABLE::G(:,:),GG(:)
    INTEGER,ALLOCATABLE::Ig(:),Jg(:)
    integer num
    ENDMODULE SparseMatrix
    
      MODULE Space_Domain_Field
    COMPLEX(8),ALLOCATABLE::EH(:,:)!,Hy(:),Ex_z(:),Ez_x(:),hz(:),Ex_y(:),Ey_x(:),Ez_y(:),Ey_z(:),Hx(:)
    real(8),ALLOCATABLE::X_right(:),R_b(:),j_right(:)
    ENDMODULE Space_Domain_Field

   
       MODULE GaussIntegral
    IMPLICIT NONE
    INTEGER n_point
    PARAMETER(n_point=10)
    REAL(8),PARAMETER::XIk(n_point)=(/-0.9739,-0.8651,-0.6794,-0.4334,-0.1489,0.1489,0.4334,0.6794,0.8651,0.9739/)
    REAL(8),PARAMETER::Ak(n_point)=(/0.0667,0.1495,0.2191,0.2693,0.2955,0.2955,0.2693,0.2191,0.1495,0.0667/)
    !PARAMETER(n_point=6)
    !REAL(8),PARAMETER::XIk(n_point)=(/-0.9324695,-0.6612094,-0.2386192,0.2386192,0.6612094,0.9324695/)
    !REAL(8),PARAMETER::Ak(n_point)=(/0.1713245,0.3607616,0.4679139,0.4679139,0.3607616,0.1713245/)
    ENDMODULE GaussIntegral
    
    
      MODULE GLOBAL_CONST
    IMPLICIT NONE
    REAL(8) pi,miu,epsilon
    PARAMETER(pi=3.1415926535897932384626433832795,miu=1.2566370614359172953850573533118E-6)
    PARAMETER(epsilon=8.85E-12)
    ENDMODULE GLOBAL_CONST
    
    ! MODULE LINKED_list
    !IMPLICIT NONE
    !TYPE NODE
    !    INTEGER j
    !    real(8) c
    !    complex(8) cc
    !    TYPE(NODE),POINTER::next,prev
    !ENDTYPE NODE
    !TYPE IndexCeo
    !    TYPE(NODE),POINTER::head,tail
    !ENDTYPE IndexCeo
    !TYPE MatLink
    !    TYPE(IndexCeo),ALLOCATABLE::ht(:) !头尾指针
    !    INTEGER,ALLOCATABLE::GAi(:)
    !ENDTYPE MatLink
    !TYPE(NODE),POINTER::Q,P
    !TYPE(MatLink) LK,LQ,LQP,Lp,lk1,Lk2,LQ1,LQP1,Lp1,Lgt,le,le1,le2,lkk,lkk1,lkk2,Lg
    !ENDMODULE LINKED_list
    
      module guangyu
    implicit none
    real(8) xc,r,Ro,SINF1,COSF1,dl,z,x,y,r_1,x3,y3,z3,r3,x4,y4,z4,r4
    real(8) x5_1,y5_1,z5_1,r5_1,x5_2,y5_2,z5_2,r5_2 !120度第一个源
    real(8) x6_1,y6_1,z6_1,r6_1,x6_2,y6_2,z6_2,r6_2 !120度第二个源
    real(8) Ic,d,mn,xrou
    integer,parameter::layer=1
     INTEGER,PARAMETER :: SP = SELECTED_INT_KIND(4)
    INTEGER,PARAMETER :: DP = SELECTED_INT_KIND(8)
    INTEGER,PARAMETER :: NumMin=-58,NumMax=60
    REAL(8),PARAMETER :: pi=3.1415926535897932384626433832795, u0=1.2566370614359172953850573533118E-6
    REAL(8),PARAMETER :: delta=log(10d0)/10d0
    REAL(8),PARAMETER :: HANKLE0(NumMin:NumMax)=(/0.364935144342236361D-06,0.459426125596165355D-06,0.578383226372192871D-06,0.728141338237451008D-06,0.916675639151023806D-06,0.115402624846588193D-05,0.145283298279464874D-05,0.182900834094847121D-05,0.230258511075556836D-05,0.289878285803243307D-05,0.364935148347905765D-05,0.459426119166381613D-05,0.578383236400647029D-05,0.728141322020057452D-05,0.916675664208662794D-05,0.115402620746486191D-04,0.145283304520830811D-04,0.182900823690450017D-04,0.230258526542845600D-04,0.289878259248948496D-04,0.364935186362704829D-04,0.459426050794428093D-04,0.578383328556258316D-04,0.728141143626773656D-04,0.916675882423198493D-04,0.115402573288427400D-03,0.145283354051004205D-03,0.182900693940545332D-03,0.230258629925653890D-03,0.289877891368842123D-03,0.364935362321233419D-03,0.459424959663396089D-03,0.578383437219697544D-03,0.728137737760237273D-03,0.916674828386695907D-03,0.115401453005088018D-02,0.145282561007697731D-02,0.182896825859384708D-02,0.230254534781380365D-02,0.289863978964461360D-02,0.364916703316100796D-02,0.459373308328486989D-02,0.578303238144557087D-02,0.727941496975758733D-02,0.916340705413079980D-02,0.115325691146795024D-01,0.145145831645573232D-01,0.182601199326851750D-01,0.229701041792819419D-01,0.288702619191586006D-01,0.362691809613232495D-01,0.454794030973154335D-01,0.569408192479313964D-01,0.709873071831030660D-01,0.880995425792317874D-01,0.108223889335475056D+00,0.131250483224772498D+00,0.155055714823168038D+00,0.176371505568192490D+00,0.185627738272899384D+00,0.169778044200095828D+00,0.103405244827180145D+00,-.302583232566519568D-01,-.227574392602047040D+00,-.362173216902200771D+00,-.205500445107856343D+00,0.337394873185992763D+00,0.317689897099411166D+00,-.513762159861197311D+00,0.309130263600250108D+00,-.126757592256220731D+00,0.461967889903805791D-01,-.180968674387848335D-01,0.835426050954768554D-02,-.447368303849678464D-02,0.261974783476745090D-02,-.160171357135694156D-02,0.997717881954532815D-03,-.626275815473540428D-03,0.394338818456790763D-03,-.248606353686170551D-03,0.156808604001991345D-03,-.989266288392209703D-04,0.624152397750552433D-04,-.393805392720510594D-04,0.248472358468080778D-04,-.156774945451894109D-04,0.989181741463740010D-05,-.624131160475038560D-05,0.393800058153355867D-05,-.248471018484922321D-05,0.156774608863295384D-05,-.989180895991358566D-06,0.624130948101973513D-06,-.393800004807653343D-06,0.248471005085087638D-06,-.156774605497409087D-06,0.989180887536634442D-07,-.624130945978242832D-07,0.393800004274196314D-07,-.248471004951089291D-07,0.156774605463750224D-07,-.989180887452087201D-08,0.624130945957005525D-08,-.393800004268861744D-08,0.248471004949749308D-08,-.156774605463413636D-08,0.989180887451241728D-09,-.624130945956793152D-09,0.393800004268808398D-09,-.248471004949735908D-09,0.156774605463410270D-09,-.989180887451233274D-10,0.624130945956791028D-10,-.393800004268807865D-10,0.248471004949735774D-10,-.156774605463410236D-10,0.989180887451233189D-11,-.624130945956791007D-11/)
    REAL(8),PARAMETER :: HANKLE1(NumMin:NumMax)=(/0.285321327390846419D-12,0.464471807787310823D-12,0.716694770893024990D-12,0.116670043179880559D-11,0.180025587053788085D-11,0.293061898426632271D-11,0.452203829443584192D-11,0.736138206246847987D-11,0.113588466344734956D-10,0.184909557196550049D-10,0.285321327381857015D-10,0.464471807764730461D-10,0.716694770836305685D-10,0.116670043165633314D-09,0.180025587018000623D-09,0.293061898336738231D-09,0.452203829217780572D-09,0.736138205679654938D-09,0.113588466202262503D-08,0.184909556838675429D-08,0.285321326482916613D-08,0.464471805506694264D-08,0.716694765164375206D-08,0.116670041740908795D-07,0.180025583439254444D-07,0.293061889347334297D-07,0.452203806637418944D-07,0.736138148960351502D-07,0.113588451955017854D-06,0.184909521051215789D-06,0.285321236588885832D-06,0.464471579703112032D-06,0.716694197971476388D-06,0.116669899268516265D-05,0.180025225564872863D-05,0.293060990407881733D-05,0.452201548605001288D-05,0.736132477044918101D-05,0.113587027236488563D-04,0.184905942328882810D-04,0.285312247279880938D-04,0.464448999719413508D-04,0.716637480172543204D-04,0.116655652622837224D-03,0.179989440489661657D-03,0.292971105869839951D-03,0.451975782811531540D-03,0.735565434583969164D-03,0.113444614727591584D-02,0.184548306327827857D-02,0.284414256619740027D-02,0.462194743491104455D-02,0.710980590181962031D-02,0.115236911444438196D-01,0.176434484568094764D-01,0.284076233465537248D-01,0.429770595748046330D-01,0.680332568691810422D-01,0.997845928531263649D-01,0.151070544458040504D+00,0.203540580591255529D+00,0.271235377139048030D+00,0.276073871275752592D+00,0.216691977203512323D+00,-.783723736784348072D-01,-.340675626730024971D+00,-.360693673468037724D+00,0.513024526436173266D+00,-.594724728868967545D-01,-.195117123412654681D+00,0.199235599568114317D+00,-.138521552524193357D+00,0.879320858992529346D-01,-.550697146427606097D-01,0.345637848240640217D-01,-.217527180247037705D-01,0.137100290937018248D-01,-.864656416608597719D-02,0.545462757688052757D-02,-.344138864200891644D-02,0.217130685868515079D-02,-.136998627892583777D-02,0.864398952031650225D-03,-.545397874411318454D-03,0.344122545098689655D-03,-.217126584577379465D-03,0.136997597482947991D-03,-.864396363547767330D-04,0.545397224192357587D-04,-.344122381768954759D-04,0.217126543550593039D-04,-.136997587177463983D-04,0.864396337661540687D-05,-.545397217690029321D-05,0.344122380135643533D-05,-.217126543140323787D-05,0.136997587074409004D-05,-.864396337402678281D-06,0.545397217625006024D-06,-.344122380119310419D-06,0.217126543136221094D-06,-.136997587073378454D-06,0.864396337400089657D-07,-.545397217624355791D-07,0.344122380119147088D-07,-.217126543136180067D-07,0.136997587073368149D-07,-.864396337400063771D-08,0.545397217624349289D-08,-.344122380119145454D-08,0.217126543136179657D-08,-.136997587073368045D-08,0.864396337400063512D-09,-.545397217624349224D-09,0.344122380119145438D-09,-.217126543136179653D-09,0.136997587073368044D-09,-.864396337400063510D-10,0.545397217624349223D-10/)
    end